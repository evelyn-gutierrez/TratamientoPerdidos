<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Evelyn Gutierrez" />
        <meta name="author" content="Vilma Romero" />
    
    
    <title>Tratamiento de valores perdidos con R</title>

        <script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <script src="site_libs/navigation-1.1/FileSaver.min.js"></script>
        <script src="site_libs/navigation-1.1/sourceembed.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/robobook-0.1/robobook.css" rel="stylesheet" />
        <link href="site_libs/robobook-0.1/robobook_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/robobook-0.1/robobook.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #c4a000; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #000000; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #000000; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #000000; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  window.initializeSourceEmbed("index.Rmd");
	  	  	  window.initializeCodeFolding("show" === "show");
	        });
    </script>
    
    <!-- code download -->
        <style>
      #rmd-source-code {
	  display: none;
      }
    </style>
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
            <!-- robobook start -->   
   <div class="book with-summary">
      <div class="book-summary">
        <ul>
          <li class="title">Tratamiento de valores perdidos con R</li>
          <li class="divider"></li>
        </ul>
        <nav role="navigation" id="toc">
          <ul>
          <li><a href="#introducción."><span class="toc-section-number">1</span> Introducción.</a></li>
          <li><a href="#laboratorio-en-r."><span class="toc-section-number">2</span> Laboratorio en R.</a></li>
          <li><a href="#exploración-de-valores-perdidos."><span class="toc-section-number">3</span> Exploración de valores perdidos.</a>
          <ul>
          <li><a href="#exploración-básica."><span class="toc-section-number">3.1</span> Exploración básica.</a></li>
          <li><a href="#visualizaciones"><span class="toc-section-number">3.2</span> Visualizaciones</a></li>
          </ul></li>
          <li><a href="#imputación-univariada"><span class="toc-section-number">4</span> Imputación Univariada</a>
          <ul>
          <li><a href="#con-la-media."><span class="toc-section-number">4.1</span> Con la media.</a></li>
          <li><a href="#con-valor-aleatorio."><span class="toc-section-number">4.2</span> Con valor aleatorio.</a></li>
          <li><a href="#con-un-valor-específico."><span class="toc-section-number">4.3</span> Con un valor específico.</a></li>
          <li><a href="#manualmente"><span class="toc-section-number">4.4</span> Manualmente</a></li>
          </ul></li>
          <li><a href="#imputación-multivariada"><span class="toc-section-number">5</span> Imputación Multivariada</a>
          <ul>
          <li><a href="#por-regresión-lineal."><span class="toc-section-number">5.1</span> Por regresión lineal.</a></li>
          <li><a href="#por-k-vecinos-más-cercanos."><span class="toc-section-number">5.2</span> Por K vecinos más cercanos.</a></li>
          <li><a href="#por-bosques-aleatorios."><span class="toc-section-number">5.3</span> Por bosques aleatorios.</a></li>
          <li><a href="#mice"><span class="toc-section-number">5.4</span> MICE</a></li>
          </ul></li>
          <li><a href="#imputación-múltiple"><span class="toc-section-number">6</span> Imputación Múltiple</a>
          <ul>
          <li><a href="#mice-1"><span class="toc-section-number">6.1</span> MICE</a></li>
          <li><a href="#visualización."><span class="toc-section-number">6.2</span> Visualización.</a></li>
          </ul></li>
          <li><a href="#modelamiento"><span class="toc-section-number">7</span> Modelamiento</a>
          <ul>
          <li><a href="#casos-completos"><span class="toc-section-number">7.1</span> Casos completos</a></li>
          <li><a href="#imputación-simple."><span class="toc-section-number">7.2</span> Imputación simple.</a></li>
          <li><a href="#imputación-múltiple."><span class="toc-section-number">7.3</span> Imputación múltiple.</a></li>
          </ul></li>
          <li><a href="#ejercicio"><span class="toc-section-number">8</span> Ejercicio</a></li>
          <li><a href="#anexos"><span class="toc-section-number">9</span> Anexos</a></li>
          </ul>
        </nav>
        <ul class="authors">
          <li class="divider"></li>
                                <li><span><i class="glyphicon glyphicon-user"></i> Evelyn Gutierrez<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></span></li>
                                          <li><span><i class="glyphicon glyphicon-user"></i> Vilma Romero<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></span></li>
                                         <li><span><i class="glyphicon glyphicon-calendar"></i> September, 2021</span></li>
                  </ul>     
      </div>
      <div class="book-body fixed">
        <div class="body-inner">
            <a class="btn pull-left js-toolbar-action toggle-sidebar" aria-label="Toggle Sidebar" title="Toggle Sidebar" href="#">
              <span class="glyphicon glyphicon-menu-hamburger"></span>
            </a>
            <div class="page-inner">
              <section id="content" class="normal">
      
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    <li role="separator" class="divider"></li>
	    	    	    	    <li><a id="rmd-download-source" href="#">Download Rmd</a></li>
	         </ul>
   </div>
   
        
      <h1 class="title">Tratamiento de valores perdidos con R</h1>
      
        

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="introducción." class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introducción.</h1>
<iframe src="files/3_Tratamiento de datos perdidos.pdf" width="768" height="600px">
</iframe>
</div>
<div id="laboratorio-en-r." class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Laboratorio en R.</h1>
<p>En esta sesión, realizaremos la imputación de datos perdidos utilizando técnicas básicas y por vecinos más cercanos.</p>
<p>Requerimos instalar los siguientes paquetes:</p>
<ul>
<li><code>Hmisc</code></li>
<li><code>VIM</code></li>
<li><code>mice</code></li>
<li><code>DMwR</code></li>
</ul>
<p>Para <code>DMwR</code>, utilizar: <code>remotes::install_github("cran/DMwR")</code></p>
</div>
<div id="exploración-de-valores-perdidos." class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Exploración de valores perdidos.</h1>
<p><br></p>
<div id="exploración-básica." class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Exploración básica.</h2>
<p><strong>Caso 1: Notas.</strong></p>
<p>Iniciamos este ejemplo, creando un data.frame notas con alguna nota faltante.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>notas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">nombre =</span> <span class="fu">c</span>(<span class="st">&quot;Jesus&quot;</span>, <span class="st">&quot;Carla&quot;</span>, <span class="st">&quot;Rodrigo&quot;</span>, <span class="st">&quot;Javier&quot;</span>),</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nota =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="cn">NA</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>notas</span></code></pre></div>
<pre><code>##    nombre nota
## 1   Jesus   12
## 2   Carla   15
## 3 Rodrigo   13
## 4  Javier   NA</code></pre>
<p>Exploramos visualmente el número de valores perdidos por variable: solo existe un valor aleatorio.</p>
<p>Finalmente, seleccionar los datos completos con <code>complete.cases</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>notas_comp <span class="ot">&lt;-</span> notas[<span class="fu">complete.cases</span>(notas),]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>notas_comp</span></code></pre></div>
<pre><code>##    nombre nota
## 1   Jesus   12
## 2   Carla   15
## 3 Rodrigo   13</code></pre>
<p><br></p>
</div>
<div id="visualizaciones" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Visualizaciones</h2>
<p><strong>Caso 2: Dataset sleep</strong></p>
<p>Utilizaremos el conjunto de datos <em>sleep</em> del paquete VIM para realizar la exploración de valores perdidos en R.</p>
<ul>
<li>Instalación:</li>
</ul>
<p>Necesitamos instalar el paquete VIM con el siguiente código en la consola: <code>install.packages("VIM")</code>.</p>
<p>Luego, cargamos los datos de <code>sleep</code> y vemos las primeras filas del dataset utilizando el siguiente código:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga los datos.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(sleep, <span class="at">package =</span> <span class="st">&quot;VIM&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vemos las 6 primeras filas.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sleep)</span></code></pre></div>
<pre><code>##    BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger
## 1 6654.000   5712.0   NA    NA   3.3 38.6  645    3   5      3
## 2    1.000      6.6  6.3   2.0   8.3  4.5   42    3   1      3
## 3    3.385     44.5   NA    NA  12.5 14.0   60    1   1      1
## 4    0.920      5.7   NA    NA  16.5   NA   25    5   2      3
## 5 2547.000   4603.0  2.1   1.8   3.9 69.0  624    3   5      4
## 6   10.550    179.5  9.1   0.7   9.8 27.0  180    4   4      4</code></pre>
<p>Comprobaremos que el dataset “sleep” ahora aparece también en su <strong>Environment</strong> en RStudio.</p>
<p>Iniciamos la <strong>exploración inicial</strong> de este nuevo dataset con alguno de los siguientes comandos básicos:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sleep)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    62 obs. of  10 variables:
##  $ BodyWgt : num  6654 1 3.38 0.92 2547 ...
##  $ BrainWgt: num  5712 6.6 44.5 5.7 4603 ...
##  $ NonD    : num  NA 6.3 NA NA 2.1 9.1 15.8 5.2 10.9 8.3 ...
##  $ Dream   : num  NA 2 NA NA 1.8 0.7 3.9 1 3.6 1.4 ...
##  $ Sleep   : num  3.3 8.3 12.5 16.5 3.9 9.8 19.7 6.2 14.5 9.7 ...
##  $ Span    : num  38.6 4.5 14 NA 69 27 19 30.4 28 50 ...
##  $ Gest    : num  645 42 60 25 624 180 35 392 63 230 ...
##  $ Pred    : int  3 3 1 5 3 4 1 4 1 1 ...
##  $ Exp     : int  5 1 1 2 5 4 1 5 2 1 ...
##  $ Danger  : int  3 3 1 3 4 4 1 4 1 1 ...</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(sleep)</span></code></pre></div>
<pre><code>## Rows: 62
## Columns: 10
## $ BodyWgt  &lt;dbl&gt; 6654.000, 1.000, 3.385, 0.920, 2547.000, 10.550, 0.023, 160.0~
## $ BrainWgt &lt;dbl&gt; 5712.0, 6.6, 44.5, 5.7, 4603.0, 179.5, 0.3, 169.0, 25.6, 440.~
## $ NonD     &lt;dbl&gt; NA, 6.3, NA, NA, 2.1, 9.1, 15.8, 5.2, 10.9, 8.3, 11.0, 3.2, 7~
## $ Dream    &lt;dbl&gt; NA, 2.0, NA, NA, 1.8, 0.7, 3.9, 1.0, 3.6, 1.4, 1.5, 0.7, 2.7,~
## $ Sleep    &lt;dbl&gt; 3.3, 8.3, 12.5, 16.5, 3.9, 9.8, 19.7, 6.2, 14.5, 9.7, 12.5, 3~
## $ Span     &lt;dbl&gt; 38.6, 4.5, 14.0, NA, 69.0, 27.0, 19.0, 30.4, 28.0, 50.0, 7.0,~
## $ Gest     &lt;dbl&gt; 645, 42, 60, 25, 624, 180, 35, 392, 63, 230, 112, 281, NA, 36~
## $ Pred     &lt;int&gt; 3, 3, 1, 5, 3, 4, 1, 4, 1, 1, 5, 5, 2, 5, 1, 2, 2, 2, 1, 1, 5~
## $ Exp      &lt;int&gt; 5, 1, 1, 2, 5, 4, 1, 5, 2, 1, 4, 5, 1, 5, 1, 2, 2, 2, 2, 1, 5~
## $ Danger   &lt;int&gt; 3, 3, 1, 3, 4, 4, 1, 4, 1, 1, 4, 5, 2, 5, 1, 2, 2, 2, 1, 1, 5~</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sleep)</span></code></pre></div>
<pre><code>##     BodyWgt            BrainWgt            NonD            Dream      
##  Min.   :   0.005   Min.   :   0.14   Min.   : 2.100   Min.   :0.000  
##  1st Qu.:   0.600   1st Qu.:   4.25   1st Qu.: 6.250   1st Qu.:0.900  
##  Median :   3.342   Median :  17.25   Median : 8.350   Median :1.800  
##  Mean   : 198.790   Mean   : 283.13   Mean   : 8.673   Mean   :1.972  
##  3rd Qu.:  48.202   3rd Qu.: 166.00   3rd Qu.:11.000   3rd Qu.:2.550  
##  Max.   :6654.000   Max.   :5712.00   Max.   :17.900   Max.   :6.600  
##                                       NA&#39;s   :14       NA&#39;s   :12     
##      Sleep            Span              Gest             Pred      
##  Min.   : 2.60   Min.   :  2.000   Min.   : 12.00   Min.   :1.000  
##  1st Qu.: 8.05   1st Qu.:  6.625   1st Qu.: 35.75   1st Qu.:2.000  
##  Median :10.45   Median : 15.100   Median : 79.00   Median :3.000  
##  Mean   :10.53   Mean   : 19.878   Mean   :142.35   Mean   :2.871  
##  3rd Qu.:13.20   3rd Qu.: 27.750   3rd Qu.:207.50   3rd Qu.:4.000  
##  Max.   :19.90   Max.   :100.000   Max.   :645.00   Max.   :5.000  
##  NA&#39;s   :4       NA&#39;s   :4         NA&#39;s   :4                       
##       Exp            Danger     
##  Min.   :1.000   Min.   :1.000  
##  1st Qu.:1.000   1st Qu.:1.000  
##  Median :2.000   Median :2.000  
##  Mean   :2.419   Mean   :2.613  
##  3rd Qu.:4.000   3rd Qu.:4.000  
##  Max.   :5.000   Max.   :5.000  
## </code></pre>
<p>En todos ellos observaremos una primera vista de los datos. Notaremos además, que existen valores NA, datos perdidos. La primera pregunta que nos hacemos es:</p>
<blockquote>
<p>¿Cuántos datos están con valores NA en este dataset?</p>
</blockquote>
<p>Para contar el número de valores perdidos por variable podemos usar este cálculo con la función <em>apply</em> que cuenta el número de valores perdidos (valores NA para R) por columna.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(sleep, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">sum</span>(<span class="fu">is.na</span>(x))})</span></code></pre></div>
<pre><code>##  BodyWgt BrainWgt     NonD    Dream    Sleep     Span     Gest     Pred 
##        0        0       14       12        4        4        4        0 
##      Exp   Danger 
##        0        0</code></pre>
<p>Ahora podemos responder lo siguiente 👩‍🏫:</p>
<ul>
<li>¿Cuántos valores perdidos hay en cada variable?</li>
<li>¿Qué variables tienen valores perdidos?</li>
<li>¿Qué variables tienen más valores perdidos? 🤚</li>
</ul>
<p><br></p>
<p>Continuamos explorando los valores perdidos analizando el <strong>patrón de valores perdidos</strong> distribuidos <strong>en las diferentes variables</strong> del conjunto de datos (dataset). Esto nos ayudará a entender mejor nuestros datos.</p>
<p>Lo hacemos utilizando la función <em>md.pattern</em> y <em>md.pairs</em> del paquete <strong>MICE</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">md.pattern</span>(sleep, <span class="at">rotate.names=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="80%" /></p>
<pre><code>##    BodyWgt BrainWgt Pred Exp Danger Sleep Span Gest Dream NonD   
## 42       1        1    1   1      1     1    1    1     1    1  0
## 9        1        1    1   1      1     1    1    1     0    0  2
## 3        1        1    1   1      1     1    1    0     1    1  1
## 2        1        1    1   1      1     1    0    1     1    1  1
## 1        1        1    1   1      1     1    0    1     0    0  3
## 1        1        1    1   1      1     1    0    0     1    1  2
## 2        1        1    1   1      1     0    1    1     1    0  2
## 2        1        1    1   1      1     0    1    1     0    0  3
##          0        0    0   0      0     4    4    4    12   14 38</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">md.pairs</span>(sleep)</span></code></pre></div>
<pre><code>## $rr
##          BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger
## BodyWgt       62       62   48    50    58   58   58   62  62     62
## BrainWgt      62       62   48    50    58   58   58   62  62     62
## NonD          48       48   48    48    48   45   44   48  48     48
## Dream         50       50   48    50    48   47   46   50  50     50
## Sleep         58       58   48    48    58   54   54   58  58     58
## Span          58       58   45    47    54   58   55   58  58     58
## Gest          58       58   44    46    54   55   58   58  58     58
## Pred          62       62   48    50    58   58   58   62  62     62
## Exp           62       62   48    50    58   58   58   62  62     62
## Danger        62       62   48    50    58   58   58   62  62     62
## 
## $rm
##          BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger
## BodyWgt        0        0   14    12     4    4    4    0   0      0
## BrainWgt       0        0   14    12     4    4    4    0   0      0
## NonD           0        0    0     0     0    3    4    0   0      0
## Dream          0        0    2     0     2    3    4    0   0      0
## Sleep          0        0   10    10     0    4    4    0   0      0
## Span           0        0   13    11     4    0    3    0   0      0
## Gest           0        0   14    12     4    3    0    0   0      0
## Pred           0        0   14    12     4    4    4    0   0      0
## Exp            0        0   14    12     4    4    4    0   0      0
## Danger         0        0   14    12     4    4    4    0   0      0
## 
## $mr
##          BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger
## BodyWgt        0        0    0     0     0    0    0    0   0      0
## BrainWgt       0        0    0     0     0    0    0    0   0      0
## NonD          14       14    0     2    10   13   14   14  14     14
## Dream         12       12    0     0    10   11   12   12  12     12
## Sleep          4        4    0     2     0    4    4    4   4      4
## Span           4        4    3     3     4    0    3    4   4      4
## Gest           4        4    4     4     4    3    0    4   4      4
## Pred           0        0    0     0     0    0    0    0   0      0
## Exp            0        0    0     0     0    0    0    0   0      0
## Danger         0        0    0     0     0    0    0    0   0      0
## 
## $mm
##          BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger
## BodyWgt        0        0    0     0     0    0    0    0   0      0
## BrainWgt       0        0    0     0     0    0    0    0   0      0
## NonD           0        0   14    12     4    1    0    0   0      0
## Dream          0        0   12    12     2    1    0    0   0      0
## Sleep          0        0    4     2     4    0    0    0   0      0
## Span           0        0    1     1     0    4    1    0   0      0
## Gest           0        0    0     0     0    1    4    0   0      0
## Pred           0        0    0     0     0    0    0    0   0      0
## Exp            0        0    0     0     0    0    0    0   0      0
## Danger         0        0    0     0     0    0    0    0   0      0</code></pre>
<p>En estos gráficos y tablas observamos las diferentes combinaciones de valores perdidos que tenemos para nuestras variables. Ahora, podemos responder las siguiente preguntas:</p>
<ul>
<li>¿Cuantas observaciones no tienen nigún valor perdido?</li>
<li>¿Cuantas observaciones no tienen nigún valor perdido?</li>
</ul>
<p>Visualización de datos perdidos</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sleep_aggr <span class="ot">&lt;-</span> VIM<span class="sc">::</span><span class="fu">aggr</span>(sleep, <span class="at">col =</span> mice<span class="sc">::</span><span class="fu">mdc</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">numbers =</span> <span class="cn">TRUE</span>, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sortVars =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="fu">names</span>(sleep),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cex.axis=</span> <span class="fl">0.7</span>, <span class="at">gap =</span> <span class="dv">3</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;Proporción de Pérdida&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Patrón de Pérdida&quot;</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<pre><code>## 
##  Variables sorted by number of missings: 
##  Variable      Count
##      NonD 0.22580645
##     Dream 0.19354839
##     Sleep 0.06451613
##      Span 0.06451613
##      Gest 0.06451613
##   BodyWgt 0.00000000
##  BrainWgt 0.00000000
##      Pred 0.00000000
##       Exp 0.00000000
##    Danger 0.00000000</code></pre>
<p>Distribución de observaciones completas e incompletas por pares de variables</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">marginplot</span>(sleep[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)], <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">marginplot</span>(sleep[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)], <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" width="768" /></p>
<p>Descripción:</p>
<ul>
<li><p>Puntos azules (diagrama de dispersión): individuos con ambos valores de las variables.</p></li>
<li><p>Boxplots azules: boxplots de los valores no perdidos de cada variable</p></li>
<li><p>Puntos rojos (Eje X: NonD): individuos con valores perdidos en Gest pero observados en NonD.</p></li>
<li><p>Puntos rojos (Eje Y: Gest): individuos con valores perdidos en NonD pero observados en Gest.</p></li>
<li><p>Boxplots rojos: Representan la distribución marginal de los puntos rojos.</p></li>
</ul>
<p>Nota: Si los datos perdidos son completamente aleatorios se espera que los boxplots rojos y azules sean idénticos</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="imputación-univariada" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Imputación Univariada</h1>
<div id="con-la-media." class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Con la media.</h2>
<p>instalamos la librería <code>Hmisc</code> para realizar imputaciones básicas. La instalación, la realizaremos utilizando el siguiente comando en la consola: <code>install.packages("Hmisc")</code>.</p>
<p>Luego de completada la instalación, comprobamos cargando el paquete.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span></code></pre></div>
<p>Si no tenemos mayor información, utilizaremos la media como valor de imputación. Es una imputación rápida, simple y sencilla.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(notas, <span class="fu">impute</span>(nota, mean))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>notas</span></code></pre></div>
<pre><code>##    nombre nota nota_imp
## 1   Jesus   12 12.00000
## 2   Carla   15 15.00000
## 3 Rodrigo   13 13.00000
## 4  Javier   NA 13.33333</code></pre>
<hr />
</div>
<div id="con-valor-aleatorio." class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Con valor aleatorio.</h2>
<p>Utilizamos un valor aleatorio como valor de imputación: Se selecciona aleatoriamente a partir de los valores no perdidos. Simple y útil en caso de MCAR.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(notas, <span class="fu">impute</span>(nota, <span class="st">&#39;random&#39;</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>notas</span></code></pre></div>
<pre><code>##    nombre nota nota_imp
## 1   Jesus   12       12
## 2   Carla   15       15
## 3 Rodrigo   13       13
## 4  Javier   NA       15</code></pre>
<hr />
</div>
<div id="con-un-valor-específico." class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Con un valor específico.</h2>
<p>Si tenemos información específica, o resulta conveniente, podemos imputar los datos perdidos con un valor específico.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(notas, <span class="fu">impute</span>(nota, <span class="dv">99</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>notas</span></code></pre></div>
<pre><code>##    nombre nota nota_imp
## 1   Jesus   12       12
## 2   Carla   15       15
## 3 Rodrigo   13       13
## 4  Javier   NA       99</code></pre>
<hr />
</div>
<div id="manualmente" class="section level2" number="4.4">
<h2 number="4.4"><span class="header-section-number">4.4</span> Manualmente</h2>
<p>Por ultimo, la imputación puede realizarse sin el paquete Hmisc de la siguiente manera:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota[<span class="fu">is.na</span>(notas<span class="sc">$</span>nota)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(notas<span class="sc">$</span>nota, <span class="at">na.rm =</span> T)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>notas</span></code></pre></div>
<pre><code>##    nombre     nota nota_imp
## 1   Jesus 12.00000       12
## 2   Carla 15.00000       15
## 3 Rodrigo 13.00000       13
## 4  Javier 13.33333       99</code></pre>
<p><br></p>
</div>
</div>
<div id="imputación-multivariada" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Imputación Multivariada</h1>
<div id="por-regresión-lineal." class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Por regresión lineal.</h2>
<p>Con la librería mice. Esta librería sirve para imputación múltiple pero podemos usarla también para imputación simple si definimos <em>m=1</em>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice) </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(sleep, <span class="at">method =</span> <span class="st">&quot;norm.predict&quot;</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit=</span><span class="dv">1</span>) <span class="co"># Impute data</span></span></code></pre></div>
<pre><code>## 
##  iter imp variable
##   1   1  NonD  Dream  Sleep  Span  Gest</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>imp_reg <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp)</span></code></pre></div>
<p>Para missings en variables categorícas se puede utilizar regresión logistica con el argumento <code>method="logreg"</code>. Ejemplo: <code>mice(nhanes2, meth = c("sample", "norm.predict", "logreg", "norm.predict"))</code></p>
<p>Para ver otros métodos, podemos ver la documentación de la función mice escribiendo <code>?mice::mice</code> en la consola.</p>
<p><br></p>
</div>
<div id="por-k-vecinos-más-cercanos." class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Por K vecinos más cercanos.</h2>
<p>Aplicamos vecions más cercanos y guardamos los resultados en sleep_imp</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DMwR)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sleep_imp <span class="ot">&lt;-</span> DMwR<span class="sc">::</span><span class="fu">knnImputation</span>(sleep)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#View(sleep_imp)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sleep_imp)</span></code></pre></div>
<pre><code>##     BodyWgt            BrainWgt            NonD            Dream      
##  Min.   :   0.005   Min.   :   0.14   Min.   : 2.100   Min.   :0.000  
##  1st Qu.:   0.600   1st Qu.:   4.25   1st Qu.: 5.800   1st Qu.:0.925  
##  Median :   3.342   Median :  17.25   Median : 8.350   Median :1.800  
##  Mean   : 198.790   Mean   : 283.13   Mean   : 8.489   Mean   :1.976  
##  3rd Qu.:  48.202   3rd Qu.: 166.00   3rd Qu.:10.757   3rd Qu.:2.567  
##  Max.   :6654.000   Max.   :5712.00   Max.   :17.900   Max.   :6.600  
##      Sleep            Span              Gest             Pred      
##  Min.   : 2.60   Min.   :  2.000   Min.   : 12.00   Min.   :1.000  
##  1st Qu.: 6.95   1st Qu.:  6.125   1st Qu.: 35.75   1st Qu.:2.000  
##  Median :10.30   Median : 13.350   Median : 65.68   Median :3.000  
##  Mean   :10.43   Mean   : 19.133   Mean   :138.65   Mean   :2.871  
##  3rd Qu.:13.20   3rd Qu.: 27.000   3rd Qu.:196.80   3rd Qu.:4.000  
##  Max.   :19.90   Max.   :100.000   Max.   :645.00   Max.   :5.000  
##       Exp            Danger     
##  Min.   :1.000   Min.   :1.000  
##  1st Qu.:1.000   1st Qu.:1.000  
##  Median :2.000   Median :2.000  
##  Mean   :2.419   Mean   :2.613  
##  3rd Qu.:4.000   3rd Qu.:4.000  
##  Max.   :5.000   Max.   :5.000</code></pre>
<p>¿Hay datos perdidos ahora?</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(sleep_imp, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">sum</span>(<span class="fu">is.na</span>(x))})</span></code></pre></div>
<pre><code>##  BodyWgt BrainWgt     NonD    Dream    Sleep     Span     Gest     Pred 
##        0        0        0        0        0        0        0        0 
##      Exp   Danger 
##        0        0</code></pre>
</div>
<div id="por-bosques-aleatorios." class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Por bosques aleatorios.</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missForest)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>sleep_imp_rf <span class="ot">&lt;-</span> <span class="fu">missForest</span>(sleep)</span></code></pre></div>
<pre><code>##   missForest iteration 1 in progress...done!
##   missForest iteration 2 in progress...done!
##   missForest iteration 3 in progress...done!</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sleep_imp<span class="sc">$</span>NonD, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1]  2.28  6.30 10.28 10.63  2.10  9.10 15.80  5.20 10.90  8.30 11.00  3.20
## [13]  7.60  4.20  6.30  8.60  6.60  9.50  4.80 12.00  4.97  3.30 11.00  8.17
## [25]  4.70 10.54 10.40  7.40  2.10  9.21  7.65  7.70 17.90  6.10  8.20  8.40
## [37] 11.90 10.80 13.80 14.30  5.25 15.20 10.00 11.90  6.50  7.50 10.50 10.60
## [49]  7.40  8.40  5.70  4.90  4.60  3.20  9.66  8.10 11.00  4.90 13.20  9.70
## [61] 12.80 12.04</code></pre>
</div>
<div id="mice" class="section level2" number="5.4">
<h2 number="5.4"><span class="header-section-number">5.4</span> MICE</h2>
<blockquote>
<p>MICE: <em>Multivariate Imputation by Chained Equations</em></p>
</blockquote>
<p>Utilizaremos la metodología MICE: Multivariate Imputation by Chained Equations para realizar imputación multivariada.</p>
<p>La imputación con MICE puede ser simple o múltiple. Simple si solo se imputa el dataset inicial; y múltiple cuando se crean multiples datasets con diferentes imputaciones.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code></pre></div>
</div>
</div>
<div id="imputación-múltiple" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Imputación Múltiple</h1>
<div id="mice-1" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> MICE</h2>
<p>Utilizamos el paquete MICE: Imputación Multivariada por Chained Equations para realizar la imputación múltiple.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code></pre></div>
<p>La imputación se realiza con estas líneas de código:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>imp1 <span class="ot">&lt;-</span> <span class="fu">mice</span>(sleep, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">seed =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
##  iter imp variable
##   1   1  NonD  Dream  Sleep  Span  Gest
##   1   2  NonD  Dream  Sleep  Span  Gest
##   1   3  NonD  Dream  Sleep  Span  Gest
##   1   4  NonD  Dream  Sleep  Span  Gest
##   1   5  NonD  Dream  Sleep  Span  Gest
##   2   1  NonD  Dream  Sleep  Span  Gest
##   2   2  NonD  Dream  Sleep  Span  Gest
##   2   3  NonD  Dream  Sleep  Span  Gest
##   2   4  NonD  Dream  Sleep  Span  Gest
##   2   5  NonD  Dream  Sleep  Span  Gest
##   3   1  NonD  Dream  Sleep  Span  Gest
##   3   2  NonD  Dream  Sleep  Span  Gest
##   3   3  NonD  Dream  Sleep  Span  Gest
##   3   4  NonD  Dream  Sleep  Span  Gest
##   3   5  NonD  Dream  Sleep  Span  Gest
##   4   1  NonD  Dream  Sleep  Span  Gest
##   4   2  NonD  Dream  Sleep  Span  Gest
##   4   3  NonD  Dream  Sleep  Span  Gest
##   4   4  NonD  Dream  Sleep  Span  Gest
##   4   5  NonD  Dream  Sleep  Span  Gest
##   5   1  NonD  Dream  Sleep  Span  Gest
##   5   2  NonD  Dream  Sleep  Span  Gest
##   5   3  NonD  Dream  Sleep  Span  Gest
##   5   4  NonD  Dream  Sleep  Span  Gest
##   5   5  NonD  Dream  Sleep  Span  Gest</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>imp1</span></code></pre></div>
<pre><code>## Class: mids
## Number of multiple imputations:  5 
## Imputation methods:
##  BodyWgt BrainWgt     NonD    Dream    Sleep     Span     Gest     Pred 
##       &quot;&quot;       &quot;&quot;    &quot;pmm&quot;    &quot;pmm&quot;    &quot;pmm&quot;    &quot;pmm&quot;    &quot;pmm&quot;       &quot;&quot; 
##      Exp   Danger 
##       &quot;&quot;       &quot;&quot; 
## PredictorMatrix:
##          BodyWgt BrainWgt NonD Dream Sleep Span Gest Pred Exp Danger
## BodyWgt        0        1    1     1     1    1    1    1   1      1
## BrainWgt       1        0    1     1     1    1    1    1   1      1
## NonD           1        1    0     1     1    1    1    1   1      1
## Dream          1        1    1     0     1    1    1    1   1      1
## Sleep          1        1    1     1     0    1    1    1   1      1
## Span           1        1    1     1     1    0    1    1   1      1
## Number of logged events:  11 
##   it im  dep meth   out
## 1  1  5 Span  pmm Sleep
## 2  1  5 Gest  pmm Sleep
## 3  3  2 Span  pmm Sleep
## 4  3  5 Span  pmm Sleep
## 5  3  5 Gest  pmm Sleep
## 6  4  1 Span  pmm Sleep</code></pre>
<p>El argumento m=5 indica que se crearan 5 datasets de imputaciones.</p>
<p>Verificamos el métodos de imputación utilizado:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>imp1<span class="sc">$</span>method</span></code></pre></div>
<pre><code>##  BodyWgt BrainWgt     NonD    Dream    Sleep     Span     Gest     Pred 
##       &quot;&quot;       &quot;&quot;    &quot;pmm&quot;    &quot;pmm&quot;    &quot;pmm&quot;    &quot;pmm&quot;    &quot;pmm&quot;       &quot;&quot; 
##      Exp   Danger 
##       &quot;&quot;       &quot;&quot;</code></pre>
<p>Como vemos, se usó el método pmm (Predictive mean matching): Un método de imputación semi-parámetrico usado por defecto para variables continuas. - Selecciona un grupo de candidatos vecino similares y cercanos, y toma uno aleatoriamente como donador.</p>
<p><br></p>
<p>Imputaciones para una variable en particular. Veamos el objeto <strong>imp1</strong>, que tiene una lista de imputados <strong>imp</strong> con un set de imputados para la columna NonD</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(imp1<span class="sc">$</span>imp<span class="sc">$</span>NonD)</span></code></pre></div>
<pre><code>##       1    2    3    4    5
## 1   3.2  3.3  2.1  2.1  3.2
## 3  10.0 12.0 10.8 11.9 11.0
## 4  11.0 10.4 12.8 17.9 13.2
## 14  2.1  3.2  3.2  2.1  3.2
## 21 12.8 11.9  7.6  4.7  8.2
## 24  8.4 11.0 11.0 11.0 10.0</code></pre>
<p>Notemos que cada columna representa a un set de valores imputados para una variable.</p>
</div>
<div id="visualización." class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Visualización.</h2>
<p>Estos gráficos nos servirán para revisar si las imputaciones realizadas son muy variables entre diferentes datasets.</p>
<ul>
<li><p>El primer gráfico muestra los valores perdidos para la variable en el eje Y: <strong>Gest</strong>.</p></li>
<li><p>Se muestran 6 cuadros correspondientes a</p>
<ul>
<li>La data original y</li>
<li>Los 5 dataset construidos con la imputación multiple.</li>
</ul></li>
<li><p>En <strong>rojo</strong> están las observaciones imputadas para la variable Gest (variable del eje Y); y en <strong>azul</strong>, todas las demás observaciones.</p></li>
<li><p>Los puntos azules son los datos observados y además imputaciones realizadas en la variable <strong>NonD</strong> (variable del eje X).</p></li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, Gest <span class="sc">~</span> NonD <span class="sc">|</span> .imp, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" width="768" /></p>
<p><br></p>
<ul>
<li><p>En el siguiente gráfico observamos el mismo tipo de diagrama. Esta vez <strong>enfocado</strong> en el análisis de otra variable: <strong>NonD</strong> (Note la diferencia en la formula utilizada <em>NonD ~ Gest</em>).</p></li>
<li><p>A partir de los <strong>puntos rosados</strong> en los diferentes cuadros, se observan las variaciones en las imputaciones para <strong>NonD</strong> en los diferentes datasets contruídos durante la imputación múltiple.</p></li>
<li><p>Notemos a partir de estos gráficos que se están imputando valores fuera de la nube de puntos creada entre estas dos variables. Aunque podría suceder.</p></li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, NonD <span class="sc">~</span> Gest <span class="sc">|</span> .imp, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
<p><br></p>
<p>Finalmente, para observar los datos de las 5 imputaciones en un solo gráfico, tenemos el siguiente código.</p>
<p><strong>Para la variable Gest</strong></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, Gest <span class="sc">~</span> NonD, <span class="at">pch =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" width="70%" /></p>
<p><strong>Para la variable NonD</strong></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, NonD <span class="sc">~</span> Gest, <span class="at">pch =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="70%" /></p>
<p><br></p>
<p>Ademas, si queremos incluir una tercera variable al análisis podemos observarla cambiando la formula como el siguiente código.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, Gest <span class="sc">~</span> NonD <span class="sc">+</span> Span , <span class="at">pch =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" width="90%" /></p>
<ul>
<li><p>Veremos la relación de la variable Gest con Span además de con NonD.</p></li>
<li><p>Los <strong>puntos rosados</strong> son los valores imputados.</p></li>
</ul>
<p><br></p>
<p>Finalmente, utilizaremos un gráfico para la densidad de las observaciones imputadas en cada dataset.</p>
<ul>
<li><p>Esto nos mostrará si las diferentes imputaciones están concentradas en los mismos valores o si cambian entre diferentes datasets.</p></li>
<li><p>Cada densidad está representada en líneas de color rosado y representan la densidad para las imputaciones en uno de los 5 datasets de la imputación múltiple.</p></li>
<li><p>La densidad en color celeste representa la densidad de los valores observados.</p></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(imp1)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" width="768" /></p>
<ul>
<li><p>Este gráfico compara la <strong>densidad de los datos observados versus la densidad de los datos imputados</strong>. Se espera que las líneas sean similares pero no idénticos.</p></li>
<li><p>Encontrar diferencias entre las diferentes imputaciones indica que las <strong>imputaciones varían</strong> entre diferentes datasets.</p></li>
</ul>
<p><br></p>
<p><strong>Streeplot</strong></p>
<ul>
<li><p>El último gráfico llamado <strong>stripplot</strong> muestra la distribución de cada variable y sus valores imputados en los multiples datasets.</p></li>
<li><p>Es <strong>otra forma</strong> de ver la <strong>distribución de los imputados</strong> en las diferentes muestras.</p></li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp1, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" width="768" /></p>
</div>
</div>
<div id="modelamiento" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Modelamiento</h1>
<div id="casos-completos" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> Casos completos</h2>
<p>El caso más simple y rápido será utilizando solo los datos completos. En este caso, omitimos las fila con valores perdidos y construimos nuestro modelo.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ajuste_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(BodyWgt <span class="sc">~</span> Sleep <span class="sc">+</span> BrainWgt, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> <span class="fu">na.omit</span>(sleep))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_cc)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BodyWgt ~ Sleep + BrainWgt, data = na.omit(sleep))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -616.89   -4.08   11.32   21.49  244.51 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.22805   51.15597   0.161    0.873    
## Sleep       -1.98795    4.25534  -0.467    0.643    
## BrainWgt     0.52013    0.02735  19.021   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 120.8 on 39 degrees of freedom
## Multiple R-squared:  0.9141, Adjusted R-squared:  0.9097 
## F-statistic: 207.6 on 2 and 39 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="imputación-simple." class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> Imputación simple.</h2>
<p>Despues de una imputación simple, el resultado es un dataset con el mismo número de filas y columna pero con todos los datos llenos con algún valor imputado. Al realizar el modelamiento, se utilizan los resultados de la imputación realizada para entrenar el modelo.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ajuste_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(BodyWgt <span class="sc">~</span> Sleep <span class="sc">+</span> BrainWgt, <span class="at">data =</span> imp_reg)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_cc)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BodyWgt ~ Sleep + BrainWgt, data = imp_reg)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1557.00     1.98    31.38    57.52  1540.42 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -126.0346   117.6638  -1.071    0.288    
## Sleep          6.2066     9.8196   0.632    0.530    
## BrainWgt       0.9137     0.0479  19.074   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 325.2 on 59 degrees of freedom
## Multiple R-squared:  0.8735, Adjusted R-squared:  0.8692 
## F-statistic: 203.7 on 2 and 59 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>Nota: Si deseamos utilizar la imputación para nuestra data de validación, tenemos que aplicar la metodología y modelos creados para la imputación a partir de la data de entrenamiento.</p></li>
<li><p>No deben realizarse modelos para imputaciones con los datos de validación sino podríamos sesgar la evaluación del modelo en la data de entrenamiento.</p></li>
</ul>
</div>
<div id="imputación-múltiple." class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> Imputación múltiple.</h2>
<ul>
<li><p>Luego de una imputación multiple, el entrenamiento del modelo debe realizarse en cada uno los múltiples datasets imputados.</p></li>
<li><p>Multiples modelos serán entrenados a partir de los datasets. Es nuestra tarea evaluar la <strong>variabilidad de los modelos</strong> en los diferentes conjuntos de datos y analizar el performance conjunto de todos ellos. (Cuando los modelos sirven para entender el problema, es mejor buscar características estables entre diferentes imputaciones.)</p></li>
<li><p>Ejemplo en R: uso de regresión lineal para los múltiples datasets imputados. El resultados del modelo es el siguiente:</p></li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ajuste_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(imp1, <span class="fu">lm</span>( BodyWgt <span class="sc">~</span> Sleep <span class="sc">+</span> BrainWgt))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_imp)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 6
##    term        estimate std.error statistic  p.value  nobs
##    &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
##  1 (Intercept) -116.     115.        -1.00  3.20e- 1    62
##  2 Sleep          5.34     9.70       0.550 5.84e- 1    62
##  3 BrainWgt       0.912    0.0476    19.2   5.18e-27    62
##  4 (Intercept) -119.     118.        -1.01  3.16e- 1    62
##  5 Sleep          5.61     9.88       0.568 5.72e- 1    62
##  6 BrainWgt       0.912    0.0478    19.1   6.10e-27    62
##  7 (Intercept) -128.     118.        -1.08  2.86e- 1    62
##  8 Sleep          6.39     9.96       0.642 5.23e- 1    62
##  9 BrainWgt       0.914    0.0480    19.0   7.19e-27    62
## 10 (Intercept) -124.     111.        -1.12  2.69e- 1    62
## 11 Sleep          6.27     9.54       0.657 5.14e- 1    62
## 12 BrainWgt       0.914    0.0478    19.1   5.73e-27    62
## 13 (Intercept) -131.     117.        -1.12  2.68e- 1    62
## 14 Sleep          6.75     9.92       0.680 4.99e- 1    62
## 15 BrainWgt       0.915    0.0480    19.1   6.57e-27    62</code></pre>
<p>Note que es posible utilizar cualquier otra función en lugar de <code>lm()</code>. El resultado será una lista de modelos para cada dataset.</p>
<p>Performance del modelo en las 5 diferentes imputaciones con la librería <em>performance</em>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(ajuste_imp<span class="sc">$</span>analyses, performance)</span></code></pre></div>
<pre><code>## [[1]]
## # Indices of model performance
## 
## AIC     |     BIC |    R2 | R2 (adj.) |    RMSE |   Sigma
## ---------------------------------------------------------
## 898.227 | 906.736 | 0.873 |     0.869 | 317.447 | 325.418
## 
## [[2]]
## # Indices of model performance
## 
## AIC     |     BIC |    R2 | R2 (adj.) |    RMSE |   Sigma
## ---------------------------------------------------------
## 898.207 | 906.715 | 0.873 |     0.869 | 317.395 | 325.364
## 
## [[3]]
## # Indices of model performance
## 
## AIC     |     BIC |    R2 | R2 (adj.) |    RMSE |   Sigma
## ---------------------------------------------------------
## 898.113 | 906.622 | 0.874 |     0.869 | 317.156 | 325.120
## 
## [[4]]
## # Indices of model performance
## 
## AIC     |     BIC |    R2 | R2 (adj.) |    RMSE |   Sigma
## ---------------------------------------------------------
## 898.092 | 906.601 | 0.874 |     0.869 | 317.103 | 325.065
## 
## [[5]]
## # Indices of model performance
## 
## AIC     |     BIC |    R2 | R2 (adj.) |    RMSE |   Sigma
## ---------------------------------------------------------
## 898.060 | 906.569 | 0.874 |     0.869 | 317.020 | 324.980</code></pre>
<p>Finalmente, el análisis de resultados se realizará combinando los resultados de cada modelos. En nuestro caso, se juntan los coeficientes y errores estándares de los 5 modelos de regresión.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ajuste_comb <span class="ot">&lt;-</span> <span class="fu">pool</span>(ajuste_imp)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_comb)</span></code></pre></div>
<pre><code>##          term     estimate   std.error  statistic       df   p.value
## 1 (Intercept) -123.4775543 116.1456478 -1.0631268 56.89702 0.2922159
## 2       Sleep    6.0728040   9.8226090  0.6182476 56.84236 0.5388816
## 3    BrainWgt    0.9133712   0.0478443 19.0904921 57.04963 0.0000000</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pool.r.squared</span>(ajuste_imp)</span></code></pre></div>
<pre><code>##           est     lo 95     hi 95 fmi
## R^2 0.8734907 0.7981373 0.9220335 NaN</code></pre>
<p>Estos resultados definen el modelo final a evaluar con la data de validación.</p>
<!-- knitr::purl() -->
</div>
</div>
<div id="ejercicio" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Ejercicio</h1>
<ul>
<li><p><a href="files/EjercicioImputacion1.pdf">Descripción del ejercicio</a></p></li>
<li><p><a href="files/Advertising.csv">Datos Advertising.csv</a></p></li>
</ul>
</div>
<div id="anexos" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> Anexos</h1>
<ul>
<li><p><a href="files/3_Tratamiento%20de%20datos%20perdidos.pdf">Slides Imputación</a></p></li>
<li><p><a href="files/GuiaRImputacion_20210904.R">Códigos utilizados en este manual en R</a></p></li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_url</span>(<span class="st">&quot;files/3_Tratamiento de datos perdidos.pdf&quot;</span>, <span class="at">height =</span> <span class="st">&quot;600px&quot;</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>notas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">nombre =</span> <span class="fu">c</span>(<span class="st">&quot;Jesus&quot;</span>, <span class="st">&quot;Carla&quot;</span>, <span class="st">&quot;Rodrigo&quot;</span>, <span class="st">&quot;Javier&quot;</span>),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nota =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="cn">NA</span>))</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>notas</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>notas_comp <span class="ot">&lt;-</span> notas[<span class="fu">complete.cases</span>(notas),]</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>notas_comp</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga los datos.</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(sleep, <span class="at">package =</span> <span class="st">&quot;VIM&quot;</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Vemos las 6 primeras filas.</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sleep)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sleep)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(sleep)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sleep)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(sleep, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">sum</span>(<span class="fu">is.na</span>(x))})</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">md.pattern</span>(sleep, <span class="at">rotate.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>mice<span class="sc">::</span><span class="fu">md.pairs</span>(sleep)</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>sleep_aggr <span class="ot">&lt;-</span> VIM<span class="sc">::</span><span class="fu">aggr</span>(sleep, <span class="at">col =</span> mice<span class="sc">::</span><span class="fu">mdc</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">numbers =</span> <span class="cn">TRUE</span>, </span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sortVars =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="fu">names</span>(sleep),</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cex.axis=</span> <span class="fl">0.7</span>, <span class="at">gap =</span> <span class="dv">3</span>,</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">&quot;Proporción de Pérdida&quot;</span>,</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Patrón de Pérdida&quot;</span>))</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">marginplot</span>(sleep[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)], <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">marginplot</span>(sleep[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)], <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación Univariada</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(notas, <span class="fu">impute</span>(nota, mean))</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>notas</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(notas, <span class="fu">impute</span>(nota, <span class="st">&#39;random&#39;</span>))</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>notas</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(notas, <span class="fu">impute</span>(nota, <span class="dv">99</span>))</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>notas</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>notas<span class="sc">$</span>nota[<span class="fu">is.na</span>(notas<span class="sc">$</span>nota)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(notas<span class="sc">$</span>nota, <span class="at">na.rm =</span> T)</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>notas</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación Multivariada</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice) </span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(sleep, <span class="at">method =</span> <span class="st">&quot;norm.predict&quot;</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit=</span><span class="dv">1</span>) <span class="co"># Impute data</span></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>imp_reg <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp)</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DMwR)</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>sleep_imp <span class="ot">&lt;-</span> DMwR<span class="sc">::</span><span class="fu">knnImputation</span>(sleep)</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a><span class="co">#View(sleep_imp)</span></span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sleep_imp)</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(sleep_imp, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="fu">sum</span>(<span class="fu">is.na</span>(x))})</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missForest)</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>sleep_imp_rf <span class="ot">&lt;-</span> <span class="fu">missForest</span>(sleep)</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sleep_imp<span class="sc">$</span>NonD, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación Multiple</span></span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>imp1 <span class="ot">&lt;-</span> <span class="fu">mice</span>(sleep, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">seed =</span> <span class="dv">2</span>)</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>imp1</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>imp1<span class="sc">$</span>method</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(imp1<span class="sc">$</span>imp<span class="sc">$</span>NonD)</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, Gest <span class="sc">~</span> NonD <span class="sc">|</span> .imp, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, NonD <span class="sc">~</span> Gest <span class="sc">|</span> .imp, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, Gest <span class="sc">~</span> NonD, <span class="at">pch =</span> <span class="dv">18</span>)</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, NonD <span class="sc">~</span> Gest, <span class="at">pch =</span> <span class="dv">18</span>)</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp1, Gest <span class="sc">~</span> NonD <span class="sc">+</span> Span , <span class="at">pch =</span> <span class="dv">18</span>)</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(imp1)</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp1, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>ajuste_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(BodyWgt <span class="sc">~</span> Sleep <span class="sc">+</span> BrainWgt, </span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> <span class="fu">na.omit</span>(sleep))</span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_cc)</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>ajuste_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(BodyWgt <span class="sc">~</span> Sleep <span class="sc">+</span> BrainWgt, <span class="at">data =</span> imp_reg)</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_cc)</span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>ajuste_imp <span class="ot">&lt;-</span> <span class="fu">with</span>(imp1, <span class="fu">lm</span>( BodyWgt <span class="sc">~</span> Sleep <span class="sc">+</span> BrainWgt))</span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_imp)</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(ajuste_imp<span class="sc">$</span>analyses, performance)</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>ajuste_comb <span class="ot">&lt;-</span> <span class="fu">pool</span>(ajuste_imp)</span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ajuste_comb)</span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a><span class="fu">pool.r.squared</span>(ajuste_imp)</span></code></pre></div>
<ul>
<li><a href="files/sleep_data_names.pdf">Descripción de columnas del dataset <em>sleep</em></a></li>
</ul>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="mailto:egutierreza@pucp.edu.pe" class="email">egutierreza@pucp.edu.pe</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="mailto:vromero@uni.pe" class="email">vromero@uni.pe</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

   
      <div id="rmd-source-code">LS0tDQp0aXRsZTogIlRyYXRhbWllbnRvIGRlIHZhbG9yZXMgcGVyZGlkb3MgY29uIFIiDQphdXRob3I6DQogIC0gRXZlbHluIEd1dGllcnJlel5bZWd1dGllcnJlemFAcHVjcC5lZHUucGVdDQogIC0gVmlsbWEgUm9tZXJvXlt2cm9tZXJvQHVuaS5wZV0NCmRhdGU6ICJTZXB0ZW1iZXIsIDIwMjEiDQpvdXRwdXQ6DQogIHJtZGZvcm1hdHM6OnJvYm9ib29rOg0KICAgIGhpZ2hsaWdodDogdGFuZ28NCiAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUNCiAgICBjb2RlX2ZvbGRpbmc6IHNob3cNCiAgICBjb2RlX2Rvd25sb2FkOiBUUlVFDQogIGh0bWxfZG9jdW1lbnQ6DQogICAgdG9jOiB5ZXMNCiAgcGRmX2RvY3VtZW50OiANCiAgICBudW1iZXJfc2VjdGlvbnM6IHllcw0KICAgIHRvYzogeWVzDQotLS0NCg0KYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9DQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpDQprbml0cjo6b3B0c19jaHVuayRzZXQod2FybmluZyA9IEZBTFNFKQ0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KG1lc3NhZ2UgPSBGQUxTRSkNCmBgYA0KDQoNCg0KIyBJbnRyb2R1Y2Npw7NuLg0KDQoNCmBgYHtyIGVjaG89RkFMU0V9DQprbml0cjo6aW5jbHVkZV91cmwoImZpbGVzLzNfVHJhdGFtaWVudG8gZGUgZGF0b3MgcGVyZGlkb3MucGRmIiwgaGVpZ2h0ID0gIjYwMHB4IikNCmBgYA0KDQoNCg0KIyBMYWJvcmF0b3JpbyBlbiBSLg0KDQpFbiBlc3RhIHNlc2nDs24sIHJlYWxpemFyZW1vcyBsYSBpbXB1dGFjacOzbiBkZSBkYXRvcyBwZXJkaWRvcyB1dGlsaXphbmRvIHTDqWNuaWNhcyBiw6FzaWNhcyB5IHBvciB2ZWNpbm9zIG3DoXMgY2VyY2Fub3MuIA0KDQpSZXF1ZXJpbW9zIGluc3RhbGFyIGxvcyBzaWd1aWVudGVzIHBhcXVldGVzOiANCg0KKiBgSG1pc2NgDQoqIGBWSU1gDQoqIGBtaWNlYA0KKiBgRE13UmANCg0KDQpQYXJhIGBETXdSYCwgdXRpbGl6YXI6IGByZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiY3Jhbi9ETXdSIilgDQoNCg0KIyBFeHBsb3JhY2nDs24gZGUgdmFsb3JlcyBwZXJkaWRvcy4NCiAgDQogIA0KDQo8YnI+DQoNCiMjIEV4cGxvcmFjacOzbiBiw6FzaWNhLg0KDQoqKkNhc28gMTogTm90YXMuKioNCiAgDQpJbmljaWFtb3MgZXN0ZSBlamVtcGxvLCBjcmVhbmRvIHVuIGRhdGEuZnJhbWUgbm90YXMgY29uIGFsZ3VuYSBub3RhIGZhbHRhbnRlLg0KICANCmBgYHtyfQ0Kbm90YXMgPC0gZGF0YS5mcmFtZShub21icmUgPSBjKCJKZXN1cyIsICJDYXJsYSIsICJSb2RyaWdvIiwgIkphdmllciIpLA0KICAgICAgICAgICAgICAgICAgICBub3RhID0gYygxMiwgMTUsIDEzLCBOQSkpDQpub3Rhcw0KYGBgDQoNCkV4cGxvcmFtb3MgdmlzdWFsbWVudGUgZWwgbsO6bWVybyBkZSB2YWxvcmVzIHBlcmRpZG9zIHBvciB2YXJpYWJsZTogc29sbyBleGlzdGUgdW4gdmFsb3IgYWxlYXRvcmlvLg0KDQpGaW5hbG1lbnRlLCBzZWxlY2Npb25hciBsb3MgZGF0b3MgY29tcGxldG9zIGNvbiBgY29tcGxldGUuY2FzZXNgLg0KYGBge3J9DQpub3Rhc19jb21wIDwtIG5vdGFzW2NvbXBsZXRlLmNhc2VzKG5vdGFzKSxdDQpub3Rhc19jb21wDQpgYGANCiANCg0KPGJyPg0KDQojIyBWaXN1YWxpemFjaW9uZXMNCg0KIA0KKipDYXNvIDI6IERhdGFzZXQgc2xlZXAqKiAgDQoNCg0KDQpVdGlsaXphcmVtb3MgZWwgY29uanVudG8gZGUgZGF0b3MgKnNsZWVwKiBkZWwgcGFxdWV0ZSBWSU0gcGFyYSByZWFsaXphciBsYSBleHBsb3JhY2nDs24gZGUgdmFsb3JlcyBwZXJkaWRvcyBlbiBSLg0KIA0KLSBJbnN0YWxhY2nDs246DQoNCk5lY2VzaXRhbW9zIGluc3RhbGFyIGVsIHBhcXVldGUgVklNIGNvbiBlbCBzaWd1aWVudGUgY8OzZGlnbyBlbiBsYSBjb25zb2xhOiBgaW5zdGFsbC5wYWNrYWdlcygiVklNIilgLg0KDQpMdWVnbywgY2FyZ2Ftb3MgbG9zIGRhdG9zIGRlIGBzbGVlcGAgeSB2ZW1vcyBsYXMgcHJpbWVyYXMgZmlsYXMgZGVsIGRhdGFzZXQgdXRpbGl6YW5kbyBlbCBzaWd1aWVudGUgY8OzZGlnbzoNCg0KDQpgYGB7cn0NCiMgQ2FyZ2EgbG9zIGRhdG9zLg0KZGF0YShzbGVlcCwgcGFja2FnZSA9ICJWSU0iKQ0KDQojIFZlbW9zIGxhcyA2IHByaW1lcmFzIGZpbGFzLg0KaGVhZChzbGVlcCkNCmBgYA0KDQoNCkNvbXByb2JhcmVtb3MgcXVlIGVsIGRhdGFzZXQgInNsZWVwIiBhaG9yYSBhcGFyZWNlIHRhbWJpw6luIGVuIHN1ICoqRW52aXJvbm1lbnQqKiBlbiBSU3R1ZGlvLiANCg0KDQpJbmljaWFtb3MgbGEgKipleHBsb3JhY2nDs24gaW5pY2lhbCoqIGRlIGVzdGUgbnVldm8gZGF0YXNldCBjb24gYWxndW5vIGRlIGxvcyBzaWd1aWVudGVzIGNvbWFuZG9zIGLDoXNpY29zOg0KDQpgYGB7cn0NCnN0cihzbGVlcCkNCmRwbHlyOjpnbGltcHNlKHNsZWVwKQ0Kc3VtbWFyeShzbGVlcCkNCmBgYA0KDQoNCkVuIHRvZG9zIGVsbG9zIG9ic2VydmFyZW1vcyB1bmEgcHJpbWVyYSB2aXN0YSBkZSBsb3MgZGF0b3MuIE5vdGFyZW1vcyBhZGVtw6FzLCBxdWUgZXhpc3RlbiB2YWxvcmVzIE5BLCBkYXRvcyBwZXJkaWRvcy4NCkxhIHByaW1lcmEgcHJlZ3VudGEgcXVlIG5vcyBoYWNlbW9zIGVzOg0KDQoNCj4gwr9DdcOhbnRvcyBkYXRvcyBlc3TDoW4gY29uIHZhbG9yZXMgTkEgZW4gZXN0ZSBkYXRhc2V0Pw0KDQoNClBhcmEgY29udGFyIGVsIG7Dum1lcm8gZGUgdmFsb3JlcyBwZXJkaWRvcyBwb3IgdmFyaWFibGUgcG9kZW1vcyB1c2FyIGVzdGUgY8OhbGN1bG8gY29uIGxhIGZ1bmNpw7NuICphcHBseSogcXVlIGN1ZW50YSBlbCBuw7ptZXJvIGRlIHZhbG9yZXMgcGVyZGlkb3MgKHZhbG9yZXMgTkEgcGFyYSBSKSBwb3IgY29sdW1uYS4gDQoNCmBgYHtyfQ0KYXBwbHkoc2xlZXAsIDIsIGZ1bmN0aW9uKHgpe3N1bShpcy5uYSh4KSl9KQ0KYGBgDQogDQogDQpBaG9yYSBwb2RlbW9zIHJlc3BvbmRlciBsbyBzaWd1aWVudGUgYHIgZW1vOjpqaSgidGVhY2hlciIpYDogDQoNCiogwr9DdcOhbnRvcyB2YWxvcmVzIHBlcmRpZG9zIGhheSBlbiBjYWRhIHZhcmlhYmxlPw0KKiDCv1F1w6kgdmFyaWFibGVzIHRpZW5lbiB2YWxvcmVzIHBlcmRpZG9zPw0KKiDCv1F1w6kgdmFyaWFibGVzIHRpZW5lbiBtw6FzIHZhbG9yZXMgcGVyZGlkb3M/IGByIGVtbzo6amkoInJhaXNlZCIpYA0KIA0KDQo8YnI+DQoNCg0KQ29udGludWFtb3MgZXhwbG9yYW5kbyBsb3MgdmFsb3JlcyBwZXJkaWRvcyBhbmFsaXphbmRvIGVsICoqcGF0csOzbiBkZSB2YWxvcmVzIHBlcmRpZG9zKiogZGlzdHJpYnVpZG9zICoqZW4gbGFzIGRpZmVyZW50ZXMgdmFyaWFibGVzKiogZGVsIGNvbmp1bnRvIGRlIGRhdG9zIChkYXRhc2V0KS4gRXN0byBub3MgYXl1ZGFyw6EgYSBlbnRlbmRlciBtZWpvciBudWVzdHJvcyBkYXRvcy4gDQoNCkxvIGhhY2Vtb3MgdXRpbGl6YW5kbyBsYSBmdW5jacOzbiAqbWQucGF0dGVybiogeSAqbWQucGFpcnMqIGRlbCBwYXF1ZXRlICoqTUlDRSoqLg0KDQpgYGB7ciBvdXQud2lkdGg9JzgwJSd9DQptaWNlOjptZC5wYXR0ZXJuKHNsZWVwLCByb3RhdGUubmFtZXM9VFJVRSkNCm1pY2U6Om1kLnBhaXJzKHNsZWVwKQ0KYGBgDQoNCkVuIGVzdG9zIGdyw6FmaWNvcyB5IHRhYmxhcyBvYnNlcnZhbW9zIGxhcyBkaWZlcmVudGVzIGNvbWJpbmFjaW9uZXMgZGUgdmFsb3JlcyBwZXJkaWRvcyBxdWUgdGVuZW1vcyBwYXJhIG51ZXN0cmFzIHZhcmlhYmxlcy4gQWhvcmEsIHBvZGVtb3MgcmVzcG9uZGVyIGxhcyBzaWd1aWVudGUgcHJlZ3VudGFzOiANCg0KKiDCv0N1YW50YXMgb2JzZXJ2YWNpb25lcyBubyB0aWVuZW4gbmlnw7puIHZhbG9yIHBlcmRpZG8/DQoqIMK/Q3VhbnRhcyBvYnNlcnZhY2lvbmVzIG5vIHRpZW5lbiBuaWfDum4gdmFsb3IgcGVyZGlkbz8NCg0KVmlzdWFsaXphY2nDs24gZGUgZGF0b3MgcGVyZGlkb3MNCmBgYHtyfQ0Kc2xlZXBfYWdnciA8LSBWSU06OmFnZ3Ioc2xlZXAsIGNvbCA9IG1pY2U6Om1kYygxOjIpLCBudW1iZXJzID0gVFJVRSwgDQogICAgICAgICAgICAgICAgICAgICAgICBzb3J0VmFycyA9IFRSVUUsIGxhYmVscyA9IG5hbWVzKHNsZWVwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGNleC5heGlzPSAwLjcsIGdhcCA9IDMsDQogICAgICAgICAgICAgICAgICAgICAgICB5bGFiID0gYygiUHJvcG9yY2nDs24gZGUgUMOpcmRpZGEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBhdHLDs24gZGUgUMOpcmRpZGEiKSkNCmBgYA0KDQpEaXN0cmlidWNpw7NuIGRlIG9ic2VydmFjaW9uZXMgY29tcGxldGFzIGUgaW5jb21wbGV0YXMgcG9yIHBhcmVzIGRlIHZhcmlhYmxlcw0KYGBge3J9DQpWSU06Om1hcmdpbnBsb3Qoc2xlZXBbICwgYygzLCA3KV0sIHBjaCA9IDE5KQ0KVklNOjptYXJnaW5wbG90KHNsZWVwWyAsIGMoMywgNyldLCBjb2wgPSBjKCJibHVlIiwgInJlZCIsICJvcmFuZ2UiKSwgcGNoID0gMjApDQpgYGANCg0KRGVzY3JpcGNpw7NuOg0KDQoqIFB1bnRvcyBhenVsZXMgKGRpYWdyYW1hIGRlIGRpc3BlcnNpw7NuKTogaW5kaXZpZHVvcyBjb24gYW1ib3MgdmFsb3JlcyBkZSBsYXMgdmFyaWFibGVzLg0KKiBCb3hwbG90cyBhenVsZXM6IGJveHBsb3RzIGRlIGxvcyB2YWxvcmVzIG5vIHBlcmRpZG9zIGRlIGNhZGEgdmFyaWFibGUNCg0KKiBQdW50b3Mgcm9qb3MgKEVqZSBYOiBOb25EKTogaW5kaXZpZHVvcyBjb24gdmFsb3JlcyBwZXJkaWRvcyBlbiBHZXN0IHBlcm8gb2JzZXJ2YWRvcyBlbiBOb25ELg0KKiBQdW50b3Mgcm9qb3MgKEVqZSBZOiBHZXN0KTogaW5kaXZpZHVvcyBjb24gdmFsb3JlcyBwZXJkaWRvcyBlbiBOb25EIHBlcm8gb2JzZXJ2YWRvcyBlbiBHZXN0Lg0KKiBCb3hwbG90cyByb2pvczogUmVwcmVzZW50YW4gbGEgZGlzdHJpYnVjacOzbiBtYXJnaW5hbCBkZSBsb3MgcHVudG9zIHJvam9zLg0KDQpOb3RhOiBTaSBsb3MgZGF0b3MgcGVyZGlkb3Mgc29uIGNvbXBsZXRhbWVudGUgYWxlYXRvcmlvcyBzZSBlc3BlcmEgcXVlDQpsb3MgYm94cGxvdHMgcm9qb3MgeSBhenVsZXMgc2VhbiBpZMOpbnRpY29zDQoNCg0KXG5ld3BhZ2UNCg0KDQojIEltcHV0YWNpw7NuIFVuaXZhcmlhZGENCg0KYGBge3IgZXZhbD1GQUxTRSwgd2FybmluZz1GQUxTRSwgaW5jbHVkZT1GQUxTRX0NCg0KIyBJbXB1dGFjacOzbiBVbml2YXJpYWRhDQoNCmBgYA0KDQojIyBDb24gbGEgbWVkaWEuDQoNCmluc3RhbGFtb3MgbGEgbGlicmVyw61hIGBIbWlzY2AgcGFyYSByZWFsaXphciBpbXB1dGFjaW9uZXMgYsOhc2ljYXMuIExhIGluc3RhbGFjacOzbiwgbGEgcmVhbGl6YXJlbW9zIHV0aWxpemFuZG8gZWwgc2lndWllbnRlIGNvbWFuZG8gZW4gbGEgY29uc29sYTogYGluc3RhbGwucGFja2FnZXMoIkhtaXNjIilgLg0KDQpMdWVnbyBkZSBjb21wbGV0YWRhIGxhIGluc3RhbGFjacOzbiwgY29tcHJvYmFtb3MgY2FyZ2FuZG8gZWwgcGFxdWV0ZS4NCg0KDQpgYGB7ciB3YXJuaW5nPUZBTFNFfQ0KbGlicmFyeShIbWlzYykNCmBgYA0KDQoNClNpIG5vIHRlbmVtb3MgbWF5b3IgaW5mb3JtYWNpw7NuLCB1dGlsaXphcmVtb3MgbGEgbWVkaWEgY29tbyB2YWxvciBkZSBpbXB1dGFjacOzbi4NCkVzIHVuYSBpbXB1dGFjacOzbiByw6FwaWRhLCBzaW1wbGUgeSBzZW5jaWxsYS4NCg0KYGBge3J9DQpub3RhcyRub3RhX2ltcCA8LSB3aXRoKG5vdGFzLCBpbXB1dGUobm90YSwgbWVhbikpDQpub3Rhcw0KYGBgDQoNCioqKg0KDQojIyBDb24gdmFsb3IgYWxlYXRvcmlvLg0KDQpVdGlsaXphbW9zIHVuIHZhbG9yIGFsZWF0b3JpbyBjb21vIHZhbG9yIGRlIGltcHV0YWNpw7NuOiBTZSBzZWxlY2Npb25hIGFsZWF0b3JpYW1lbnRlIGEgcGFydGlyIGRlIGxvcyB2YWxvcmVzIG5vIHBlcmRpZG9zLiBTaW1wbGUgeSDDunRpbCBlbiBjYXNvIGRlIE1DQVIuDQoNCmBgYHtyfQ0Kbm90YXMkbm90YV9pbXAgPC0gd2l0aChub3RhcywgaW1wdXRlKG5vdGEsICdyYW5kb20nKSkNCm5vdGFzDQpgYGANCg0KKioqDQoNCiMjIENvbiB1biB2YWxvciBlc3BlY8OtZmljby4NCg0KU2kgdGVuZW1vcyBpbmZvcm1hY2nDs24gZXNwZWPDrWZpY2EsIG8gcmVzdWx0YSBjb252ZW5pZW50ZSwgcG9kZW1vcyBpbXB1dGFyIGxvcyBkYXRvcyBwZXJkaWRvcyBjb24gdW4gdmFsb3IgZXNwZWPDrWZpY28uDQoNCg0KYGBge3J9DQpub3RhcyRub3RhX2ltcCA8LSB3aXRoKG5vdGFzLCBpbXB1dGUobm90YSwgOTkpKQ0Kbm90YXMNCmBgYA0KDQoqKioNCg0KIyMgTWFudWFsbWVudGUNCg0KUG9yIHVsdGltbywgbGEgaW1wdXRhY2nDs24gcHVlZGUgcmVhbGl6YXJzZSBzaW4gZWwgcGFxdWV0ZSBIbWlzYyBkZSBsYSBzaWd1aWVudGUgbWFuZXJhOg0KDQpgYGB7cn0NCm5vdGFzJG5vdGFbaXMubmEobm90YXMkbm90YSldIDwtIG1lYW4obm90YXMkbm90YSwgbmEucm0gPSBUKQ0Kbm90YXMNCmBgYA0KDQoNCjxicj4NCg0KIyBJbXB1dGFjacOzbiBNdWx0aXZhcmlhZGENCg0KYGBge3IgZXZhbD1GQUxTRSwgd2FybmluZz1GQUxTRSwgaW5jbHVkZT1GQUxTRX0NCg0KIyBJbXB1dGFjacOzbiBNdWx0aXZhcmlhZGENCg0KYGBgDQoNCiMjIFBvciByZWdyZXNpw7NuIGxpbmVhbC4NCg0KQ29uIGxhIGxpYnJlcsOtYSBtaWNlLiBFc3RhIGxpYnJlcsOtYSBzaXJ2ZSBwYXJhIGltcHV0YWNpw7NuIG3Dumx0aXBsZSBwZXJvIHBvZGVtb3MgdXNhcmxhIHRhbWJpw6luIHBhcmEgaW1wdXRhY2nDs24gc2ltcGxlIHNpIGRlZmluaW1vcyAqbT0xKi4gIA0KDQpgYGB7cn0NCmxpYnJhcnkobWljZSkgDQppbXAgPC0gbWljZShzbGVlcCwgbWV0aG9kID0gIm5vcm0ucHJlZGljdCIsIG0gPSAxLCBtYXhpdD0xKSAjIEltcHV0ZSBkYXRhDQppbXBfcmVnIDwtIGNvbXBsZXRlKGltcCkNCmBgYA0KDQpQYXJhIG1pc3NpbmdzIGVuIHZhcmlhYmxlcyBjYXRlZ29yw61jYXMgc2UgcHVlZGUgdXRpbGl6YXIgcmVncmVzacOzbiBsb2dpc3RpY2EgY29uIGVsIGFyZ3VtZW50byBgbWV0aG9kPSJsb2dyZWciYC4gRWplbXBsbzogDQpgbWljZShuaGFuZXMyLCBtZXRoID0gYygic2FtcGxlIiwgIm5vcm0ucHJlZGljdCIsICJsb2dyZWciLCAibm9ybS5wcmVkaWN0IikpYA0KDQpQYXJhIHZlciBvdHJvcyBtw6l0b2RvcywgcG9kZW1vcyB2ZXIgbGEgZG9jdW1lbnRhY2nDs24gZGUgbGEgZnVuY2nDs24gbWljZSBlc2NyaWJpZW5kbyBgP21pY2U6Om1pY2VgIGVuIGxhIGNvbnNvbGEuDQoNCjxicj4NCg0KIyMgUG9yIEsgdmVjaW5vcyBtw6FzIGNlcmNhbm9zLg0KIA0KQXBsaWNhbW9zIHZlY2lvbnMgbcOhcyBjZXJjYW5vcyB5IGd1YXJkYW1vcyBsb3MgcmVzdWx0YWRvcyBlbiBzbGVlcF9pbXANCg0KYGBge3J9DQpsaWJyYXJ5KERNd1IpDQpzbGVlcF9pbXAgPC0gRE13Ujo6a25uSW1wdXRhdGlvbihzbGVlcCkNCiNWaWV3KHNsZWVwX2ltcCkNCnN1bW1hcnkoc2xlZXBfaW1wKQ0KYGBgDQoNCsK/SGF5IGRhdG9zIHBlcmRpZG9zIGFob3JhPyANCg0KYGBge3J9DQphcHBseShzbGVlcF9pbXAsIDIsIGZ1bmN0aW9uKHgpe3N1bShpcy5uYSh4KSl9KQ0KYGBgDQoNCg0KIyMgUG9yIGJvc3F1ZXMgYWxlYXRvcmlvcy4NCg0KYGBge3J9DQpsaWJyYXJ5KG1pc3NGb3Jlc3QpDQpzbGVlcF9pbXBfcmYgPC0gbWlzc0ZvcmVzdChzbGVlcCkNCnByaW50KHNsZWVwX2ltcCROb25ELCBkaWdpdHMgPSAzKQ0KYGBgDQoNCiMjIE1JQ0UNCg0KPiBNSUNFOiAqTXVsdGl2YXJpYXRlIEltcHV0YXRpb24gYnkgQ2hhaW5lZCBFcXVhdGlvbnMqDQoNClV0aWxpemFyZW1vcyBsYSBtZXRvZG9sb2fDrWEgTUlDRTogTXVsdGl2YXJpYXRlIEltcHV0YXRpb24gYnkgQ2hhaW5lZCBFcXVhdGlvbnMgcGFyYSByZWFsaXphciBpbXB1dGFjacOzbiBtdWx0aXZhcmlhZGEuDQoNCkxhIGltcHV0YWNpw7NuIGNvbiBNSUNFIHB1ZWRlIHNlciBzaW1wbGUgbyBtw7psdGlwbGUuIFNpbXBsZSBzaSBzb2xvIHNlIGltcHV0YSBlbCBkYXRhc2V0IGluaWNpYWw7IHkgbcO6bHRpcGxlIGN1YW5kbyBzZSBjcmVhbiBtdWx0aXBsZXMgZGF0YXNldHMgY29uIGRpZmVyZW50ZXMgaW1wdXRhY2lvbmVzLg0KDQoNCmBgYHtyfQ0KbGlicmFyeShWSU0pDQpsaWJyYXJ5KG1pY2UpDQpgYGANCiANCg0KIyBJbXB1dGFjacOzbiBNw7psdGlwbGUNCg0KYGBge3IgZXZhbD1GQUxTRSwgd2FybmluZz1GQUxTRSwgaW5jbHVkZT1GQUxTRX0NCg0KIyBJbXB1dGFjacOzbiBNdWx0aXBsZQ0KDQpgYGANCg0KIyMgTUlDRQ0KDQpVdGlsaXphbW9zIGVsIHBhcXVldGUgTUlDRTogSW1wdXRhY2nDs24gTXVsdGl2YXJpYWRhIHBvciBDaGFpbmVkIEVxdWF0aW9ucyBwYXJhIHJlYWxpemFyIGxhIGltcHV0YWNpw7NuIG3Dumx0aXBsZS4NCg0KYGBge3J9DQpsaWJyYXJ5KG1pY2UpDQpgYGANCg0KTGEgaW1wdXRhY2nDs24gc2UgcmVhbGl6YSBjb24gZXN0YXMgbMOtbmVhcyBkZSBjw7NkaWdvOg0KDQpgYGB7cn0NCmltcDEgPC0gbWljZShzbGVlcCwgbSA9IDUsIHNlZWQgPSAyKQ0KaW1wMQ0KYGBgDQoNCkVsIGFyZ3VtZW50byBtPTUgaW5kaWNhIHF1ZSBzZSBjcmVhcmFuIDUgZGF0YXNldHMgZGUgaW1wdXRhY2lvbmVzLg0KDQoNClZlcmlmaWNhbW9zIGVsIG3DqXRvZG9zIGRlIGltcHV0YWNpw7NuIHV0aWxpemFkbzoNCmBgYHtyfQ0KaW1wMSRtZXRob2QNCmBgYA0KDQpDb21vIHZlbW9zLCBzZSB1c8OzIGVsIG3DqXRvZG8gcG1tIChQcmVkaWN0aXZlIG1lYW4gbWF0Y2hpbmcpOiBVbiBtw6l0b2RvIGRlIGltcHV0YWNpw7NuIHNlbWktcGFyw6FtZXRyaWNvIHVzYWRvIHBvciBkZWZlY3RvIHBhcmEgdmFyaWFibGVzIGNvbnRpbnVhcy4gDQogIC0gU2VsZWNjaW9uYSB1biBncnVwbyBkZSBjYW5kaWRhdG9zIHZlY2lubyBzaW1pbGFyZXMgeSBjZXJjYW5vcywgeSB0b21hIHVubyBhbGVhdG9yaWFtZW50ZSBjb21vIGRvbmFkb3IuDQoNCg0KPGJyPg0KDQoNCkltcHV0YWNpb25lcyBwYXJhIHVuYSB2YXJpYWJsZSBlbiBwYXJ0aWN1bGFyLiBWZWFtb3MgZWwgb2JqZXRvICoqaW1wMSoqLCBxdWUgdGllbmUgdW5hIGxpc3RhIGRlIGltcHV0YWRvcyAqKmltcCoqIGNvbiB1biBzZXQgZGUgaW1wdXRhZG9zIHBhcmEgbGEgY29sdW1uYSBOb25EIA0KDQpgYGB7cn0NCmhlYWQoaW1wMSRpbXAkTm9uRCkNCmBgYA0KDQpOb3RlbW9zIHF1ZSBjYWRhIGNvbHVtbmEgcmVwcmVzZW50YSBhIHVuIHNldCBkZSB2YWxvcmVzIGltcHV0YWRvcyBwYXJhIHVuYSB2YXJpYWJsZS4NCg0KIyMgVmlzdWFsaXphY2nDs24uDQoNCkVzdG9zIGdyw6FmaWNvcyBub3Mgc2Vydmlyw6FuIHBhcmEgcmV2aXNhciBzaSBsYXMgaW1wdXRhY2lvbmVzIHJlYWxpemFkYXMgc29uIG11eSB2YXJpYWJsZXMgZW50cmUgZGlmZXJlbnRlcyBkYXRhc2V0cy4NCg0KLSBFbCBwcmltZXIgZ3LDoWZpY28gbXVlc3RyYSBsb3MgdmFsb3JlcyBwZXJkaWRvcyBwYXJhIGxhIHZhcmlhYmxlIGVuIGVsIGVqZSBZOiAqKkdlc3QqKi4NCg0KLSBTZSBtdWVzdHJhbiA2IGN1YWRyb3MgY29ycmVzcG9uZGllbnRlcyBhIA0KICANCiAgICAtIExhIGRhdGEgb3JpZ2luYWwgeSANCiAgICAtIExvcyA1IGRhdGFzZXQgY29uc3RydWlkb3MgY29uIGxhIGltcHV0YWNpw7NuIG11bHRpcGxlLiANCiAgICANCi0gRW4gKipyb2pvKiogZXN0w6FuIGxhcyBvYnNlcnZhY2lvbmVzIGltcHV0YWRhcyBwYXJhIGxhIHZhcmlhYmxlIEdlc3QgKHZhcmlhYmxlIGRlbCBlamUgWSk7IHkgZW4gKiphenVsKiosIHRvZGFzIGxhcyBkZW3DoXMgb2JzZXJ2YWNpb25lcy4gDQoNCi0gTG9zIHB1bnRvcyBhenVsZXMgc29uIGxvcyBkYXRvcyBvYnNlcnZhZG9zIHkgYWRlbcOhcyBpbXB1dGFjaW9uZXMgcmVhbGl6YWRhcyBlbiBsYSB2YXJpYWJsZSAqKk5vbkQqKiAodmFyaWFibGUgZGVsIGVqZSBYKS4gDQoNCmBgYHtyfQ0KbGlicmFyeShsYXR0aWNlKQ0KeHlwbG90KGltcDEsIEdlc3QgfiBOb25EIHwgLmltcCwgcGNoID0gMjAsIGNleCA9IDEuNCkNCmBgYA0KDQo8YnI+DQoNCg0KLSBFbiBlbCBzaWd1aWVudGUgZ3LDoWZpY28gb2JzZXJ2YW1vcyBlbCBtaXNtbyB0aXBvIGRlIGRpYWdyYW1hLiBFc3RhIHZleiAqKmVuZm9jYWRvKiogZW4gZWwgYW7DoWxpc2lzIGRlIG90cmEgdmFyaWFibGU6ICoqTm9uRCoqIChOb3RlIGxhIGRpZmVyZW5jaWEgZW4gbGEgZm9ybXVsYSB1dGlsaXphZGEgKk5vbkQgfiBHZXN0KikuIA0KDQoNCi0gQSBwYXJ0aXIgZGUgbG9zICoqcHVudG9zIHJvc2Fkb3MqKiBlbiBsb3MgZGlmZXJlbnRlcyBjdWFkcm9zLCBzZSBvYnNlcnZhbiBsYXMgdmFyaWFjaW9uZXMgZW4gbGFzIGltcHV0YWNpb25lcyBwYXJhICoqTm9uRCoqIGVuIGxvcyBkaWZlcmVudGVzIGRhdGFzZXRzIGNvbnRydcOtZG9zIGR1cmFudGUgbGEgaW1wdXRhY2nDs24gbcO6bHRpcGxlLiANCg0KDQotIE5vdGVtb3MgYSBwYXJ0aXIgZGUgZXN0b3MgZ3LDoWZpY29zIHF1ZSBzZSBlc3TDoW4gaW1wdXRhbmRvIHZhbG9yZXMgZnVlcmEgZGUgbGEgbnViZSBkZSBwdW50b3MgY3JlYWRhIGVudHJlIGVzdGFzIGRvcyB2YXJpYWJsZXMuIEF1bnF1ZSBwb2Ryw61hIHN1Y2VkZXIuIA0KDQoNCmBgYHtyfQ0KeHlwbG90KGltcDEsIE5vbkQgfiBHZXN0IHwgLmltcCwgcGNoID0gMjAsIGNleCA9IDEuNCkNCmBgYA0KDQoNCjxicj4NCg0KRmluYWxtZW50ZSwgcGFyYSBvYnNlcnZhciBsb3MgZGF0b3MgZGUgbGFzIDUgaW1wdXRhY2lvbmVzIGVuIHVuIHNvbG8gZ3LDoWZpY28sIHRlbmVtb3MgZWwgc2lndWllbnRlIGPDs2RpZ28uDQoNCioqUGFyYSBsYSB2YXJpYWJsZSBHZXN0KioNCg0KYGBge3Igb3V0LndpZHRoPSc3MCUnfQ0KeHlwbG90KGltcDEsIEdlc3QgfiBOb25ELCBwY2ggPSAxOCkNCmBgYA0KDQoqKlBhcmEgbGEgdmFyaWFibGUgTm9uRCoqDQoNCmBgYHtyIG91dC53aWR0aD0nNzAlJ30NCnh5cGxvdChpbXAxLCBOb25EIH4gR2VzdCwgcGNoID0gMTgpDQpgYGANCg0KPGJyPg0KDQoNCkFkZW1hcywgc2kgcXVlcmVtb3MgaW5jbHVpciB1bmEgdGVyY2VyYSB2YXJpYWJsZSBhbCBhbsOhbGlzaXMgcG9kZW1vcyBvYnNlcnZhcmxhIGNhbWJpYW5kbyBsYSBmb3JtdWxhIGNvbW8gZWwgc2lndWllbnRlIGPDs2RpZ28uDQoNCmBgYHtyIG91dC53aWR0aD0nOTAlJ30NCnh5cGxvdChpbXAxLCBHZXN0IH4gTm9uRCArIFNwYW4gLCBwY2ggPSAxOCkNCmBgYA0KDQotIFZlcmVtb3MgbGEgcmVsYWNpw7NuIGRlIGxhIHZhcmlhYmxlIEdlc3QgY29uIFNwYW4gYWRlbcOhcyBkZSBjb24gTm9uRC4NCg0KLSBMb3MgKipwdW50b3Mgcm9zYWRvcyoqIHNvbiBsb3MgdmFsb3JlcyBpbXB1dGFkb3MuDQoNCg0KPGJyPg0KDQoNCkZpbmFsbWVudGUsIHV0aWxpemFyZW1vcyB1biBncsOhZmljbyBwYXJhIGxhIGRlbnNpZGFkIGRlIGxhcyBvYnNlcnZhY2lvbmVzIGltcHV0YWRhcyBlbiBjYWRhIGRhdGFzZXQuDQoNCi0gRXN0byBub3MgbW9zdHJhcsOhIHNpIGxhcyBkaWZlcmVudGVzIGltcHV0YWNpb25lcyBlc3TDoW4gY29uY2VudHJhZGFzIGVuIGxvcyBtaXNtb3MgdmFsb3JlcyBvIHNpIGNhbWJpYW4gZW50cmUgZGlmZXJlbnRlcyBkYXRhc2V0cy4gDQoNCi0gQ2FkYSBkZW5zaWRhZCBlc3TDoSByZXByZXNlbnRhZGEgZW4gbMOtbmVhcyBkZSBjb2xvciByb3NhZG8geSByZXByZXNlbnRhbiBsYSBkZW5zaWRhZCBwYXJhIGxhcyBpbXB1dGFjaW9uZXMgZW4gdW5vIGRlIGxvcyA1IGRhdGFzZXRzIGRlIGxhIGltcHV0YWNpw7NuIG3Dumx0aXBsZS4NCg0KLSBMYSBkZW5zaWRhZCBlbiBjb2xvciBjZWxlc3RlIHJlcHJlc2VudGEgbGEgZGVuc2lkYWQgZGUgbG9zIHZhbG9yZXMgb2JzZXJ2YWRvcy4NCg0KDQpgYGB7cn0NCmRlbnNpdHlwbG90KGltcDEpDQpgYGANCg0KLSBFc3RlIGdyw6FmaWNvIGNvbXBhcmEgbGEgKipkZW5zaWRhZCBkZSBsb3MgZGF0b3Mgb2JzZXJ2YWRvcyB2ZXJzdXMgbGEgZGVuc2lkYWQgZGUgbG9zIGRhdG9zIGltcHV0YWRvcyoqLiBTZSBlc3BlcmEgcXVlIGxhcyBsw61uZWFzIHNlYW4gc2ltaWxhcmVzIHBlcm8gbm8gaWTDqW50aWNvcy4NCg0KLSBFbmNvbnRyYXIgZGlmZXJlbmNpYXMgZW50cmUgbGFzIGRpZmVyZW50ZXMgaW1wdXRhY2lvbmVzIGluZGljYSBxdWUgbGFzICoqaW1wdXRhY2lvbmVzIHZhcsOtYW4qKiBlbnRyZSBkaWZlcmVudGVzIGRhdGFzZXRzLg0KDQoNCjxicj4NCg0KKipTdHJlZXBsb3QqKg0KDQotIEVsIMO6bHRpbW8gZ3LDoWZpY28gbGxhbWFkbyAqKnN0cmlwcGxvdCoqIG11ZXN0cmEgbGEgZGlzdHJpYnVjacOzbiBkZSBjYWRhIHZhcmlhYmxlIHkgc3VzIHZhbG9yZXMgaW1wdXRhZG9zIGVuIGxvcyBtdWx0aXBsZXMgZGF0YXNldHMuIA0KDQotIEVzICoqb3RyYSBmb3JtYSoqIGRlIHZlciBsYSAqKmRpc3RyaWJ1Y2nDs24gZGUgbG9zIGltcHV0YWRvcyoqIGVuIGxhcyBkaWZlcmVudGVzIG11ZXN0cmFzLiANCg0KYGBge3J9DQpzdHJpcHBsb3QoaW1wMSwgcGNoID0gMjApDQpgYGANCg0KDQojIE1vZGVsYW1pZW50byAgDQoNCg0KIyMgQ2Fzb3MgY29tcGxldG9zDQoNCkVsIGNhc28gbcOhcyBzaW1wbGUgeSByw6FwaWRvIHNlcsOhIHV0aWxpemFuZG8gc29sbyBsb3MgZGF0b3MgY29tcGxldG9zLg0KRW4gZXN0ZSBjYXNvLCBvbWl0aW1vcyBsYXMgZmlsYSBjb24gdmFsb3JlcyBwZXJkaWRvcyB5IGNvbnN0cnVpbW9zIG51ZXN0cm8gbW9kZWxvLg0KDQpgYGB7cn0NCmFqdXN0ZV9jYyA8LSBsbShCb2R5V2d0IH4gU2xlZXAgKyBCcmFpbldndCwgDQogICAgICAgICAgICAgICAgZGF0YSA9IG5hLm9taXQoc2xlZXApKQ0Kc3VtbWFyeShhanVzdGVfY2MpDQpgYGANCg0KIyMgSW1wdXRhY2nDs24gc2ltcGxlLg0KDQpEZXNwdWVzIGRlIHVuYSBpbXB1dGFjacOzbiBzaW1wbGUsIGVsIHJlc3VsdGFkbyBlcyB1biBkYXRhc2V0IGNvbiBlbCBtaXNtbyBuw7ptZXJvIGRlIGZpbGFzIHkgY29sdW1uYSBwZXJvIGNvbiB0b2RvcyBsb3MgZGF0b3MgbGxlbm9zIGNvbiBhbGfDum4gdmFsb3IgaW1wdXRhZG8uIA0KQWwgcmVhbGl6YXIgZWwgbW9kZWxhbWllbnRvLCBzZSB1dGlsaXphbiBsb3MgcmVzdWx0YWRvcyBkZSBsYSBpbXB1dGFjacOzbiByZWFsaXphZGEgcGFyYSBlbnRyZW5hciBlbCBtb2RlbG8uIA0KDQpgYGB7cn0NCmFqdXN0ZV9jYyA8LSBsbShCb2R5V2d0IH4gU2xlZXAgKyBCcmFpbldndCwgZGF0YSA9IGltcF9yZWcpDQpzdW1tYXJ5KGFqdXN0ZV9jYykNCmBgYA0KDQotIE5vdGE6IFNpIGRlc2VhbW9zIHV0aWxpemFyIGxhIGltcHV0YWNpw7NuIHBhcmEgbnVlc3RyYSBkYXRhIGRlIHZhbGlkYWNpw7NuLCB0ZW5lbW9zIHF1ZSBhcGxpY2FyIGxhIG1ldG9kb2xvZ8OtYSB5IG1vZGVsb3MgY3JlYWRvcyBwYXJhIGxhIGltcHV0YWNpw7NuIGEgcGFydGlyIGRlIGxhIGRhdGEgZGUgZW50cmVuYW1pZW50by4gDQoNCi0gTm8gZGViZW4gcmVhbGl6YXJzZSBtb2RlbG9zIHBhcmEgaW1wdXRhY2lvbmVzIGNvbiBsb3MgZGF0b3MgZGUgdmFsaWRhY2nDs24gc2lubyBwb2Ryw61hbW9zIHNlc2dhciBsYSBldmFsdWFjacOzbiBkZWwgbW9kZWxvIGVuIGxhIGRhdGEgZGUgZW50cmVuYW1pZW50by4gDQoNCg0KIyMgSW1wdXRhY2nDs24gbcO6bHRpcGxlLg0KDQoNCi0gTHVlZ28gZGUgdW5hIGltcHV0YWNpw7NuIG11bHRpcGxlLCBlbCBlbnRyZW5hbWllbnRvIGRlbCBtb2RlbG8gZGViZSByZWFsaXphcnNlIGVuIGNhZGEgdW5vIGxvcyBtw7psdGlwbGVzIGRhdGFzZXRzIGltcHV0YWRvcy4gDQoNCi0gTXVsdGlwbGVzIG1vZGVsb3Mgc2Vyw6FuIGVudHJlbmFkb3MgYSBwYXJ0aXIgZGUgbG9zIGRhdGFzZXRzLiBFcyBudWVzdHJhIHRhcmVhIGV2YWx1YXIgbGEgKip2YXJpYWJpbGlkYWQgZGUgbG9zIG1vZGVsb3MqKiBlbiBsb3MgZGlmZXJlbnRlcyBjb25qdW50b3MgZGUgZGF0b3MgeSBhbmFsaXphciBlbCBwZXJmb3JtYW5jZSBjb25qdW50byBkZSB0b2RvcyBlbGxvcy4gKEN1YW5kbyBsb3MgbW9kZWxvcyBzaXJ2ZW4gcGFyYSBlbnRlbmRlciBlbCBwcm9ibGVtYSwgZXMgbWVqb3IgYnVzY2FyIGNhcmFjdGVyw61zdGljYXMgZXN0YWJsZXMgZW50cmUgZGlmZXJlbnRlcyBpbXB1dGFjaW9uZXMuKQ0KDQotIEVqZW1wbG8gZW4gUjogdXNvIGRlIHJlZ3Jlc2nDs24gbGluZWFsIHBhcmEgbG9zIG3Dumx0aXBsZXMgZGF0YXNldHMgaW1wdXRhZG9zLiBFbCByZXN1bHRhZG9zIGRlbCBtb2RlbG8gZXMgZWwgc2lndWllbnRlOiANCg0KYGBge3J9DQphanVzdGVfaW1wIDwtIHdpdGgoaW1wMSwgbG0oIEJvZHlXZ3QgfiBTbGVlcCArIEJyYWluV2d0KSkNCnN1bW1hcnkoYWp1c3RlX2ltcCkNCmBgYA0KDQpOb3RlIHF1ZSBlcyBwb3NpYmxlIHV0aWxpemFyIGN1YWxxdWllciBvdHJhIGZ1bmNpw7NuIGVuIGx1Z2FyIGRlIGBsbSgpYC4NCkVsIHJlc3VsdGFkbyBzZXLDoSB1bmEgbGlzdGEgZGUgbW9kZWxvcyBwYXJhIGNhZGEgZGF0YXNldC4NCg0KUGVyZm9ybWFuY2UgZGVsIG1vZGVsbyBlbiBsYXMgNSBkaWZlcmVudGVzIGltcHV0YWNpb25lcyBjb24gbGEgbGlicmVyw61hICpwZXJmb3JtYW5jZSouICANCg0KYGBge3J9DQpsaWJyYXJ5KHBlcmZvcm1hbmNlKQ0KbGFwcGx5KGFqdXN0ZV9pbXAkYW5hbHlzZXMsIHBlcmZvcm1hbmNlKQ0KYGBgDQoNCg0KDQpGaW5hbG1lbnRlLCBlbCBhbsOhbGlzaXMgZGUgcmVzdWx0YWRvcyBzZSByZWFsaXphcsOhIGNvbWJpbmFuZG8gbG9zIHJlc3VsdGFkb3MgZGUgY2FkYSBtb2RlbG9zLiANCkVuIG51ZXN0cm8gY2Fzbywgc2UganVudGFuIGxvcyBjb2VmaWNpZW50ZXMgeSBlcnJvcmVzIGVzdMOhbmRhcmVzIGRlIGxvcyA1IG1vZGVsb3MgZGUgcmVncmVzacOzbi4NCg0KYGBge3J9DQphanVzdGVfY29tYiA8LSBwb29sKGFqdXN0ZV9pbXApDQpzdW1tYXJ5KGFqdXN0ZV9jb21iKQ0KcG9vbC5yLnNxdWFyZWQoYWp1c3RlX2ltcCkNCmBgYA0KDQoNCg0KRXN0b3MgcmVzdWx0YWRvcyBkZWZpbmVuIGVsIG1vZGVsbyBmaW5hbCBhIGV2YWx1YXIgY29uIGxhIGRhdGEgZGUgdmFsaWRhY2nDs24uIA0KDQo8IS0tIGtuaXRyOjpwdXJsKCkgLS0+DQoNCg0KDQojIEVqZXJjaWNpbw0KDQotIFtEZXNjcmlwY2nDs24gZGVsIGVqZXJjaWNpb10oZmlsZXMvRWplcmNpY2lvSW1wdXRhY2lvbjEucGRmKQ0KDQotIFtEYXRvcyBBZHZlcnRpc2luZy5jc3ZdKGZpbGVzL0FkdmVydGlzaW5nLmNzdikNCg0KIyBBbmV4b3MNCg0KLSBbU2xpZGVzIEltcHV0YWNpw7NuXShmaWxlcy8zX1RyYXRhbWllbnRvIGRlIGRhdG9zIHBlcmRpZG9zLnBkZikNCg0KLSBbQ8OzZGlnb3MgdXRpbGl6YWRvcyBlbiBlc3RlIG1hbnVhbCBlbiBSXShmaWxlcy9HdWlhUkltcHV0YWNpb25fMjAyMTA5MDQuUikNCg0KYGBge3IgcmVmLmxhYmVsPWtuaXRyOjphbGxfbGFiZWxzKCksIGVjaG89VFJVRSwgZXZhbD1GQUxTRSwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9IA0KYGBgIA0KDQoNCi0gW0Rlc2NyaXBjacOzbiBkZSBjb2x1bW5hcyBkZWwgZGF0YXNldCBfc2xlZXBfXShmaWxlcy9zbGVlcF9kYXRhX25hbWVzLnBkZikNCg==</div>
   
           </section>
  </div>
  </div>
  </div>
  </div>
      
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
